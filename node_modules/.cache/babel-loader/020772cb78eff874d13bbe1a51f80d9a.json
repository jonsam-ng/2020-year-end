{"ast":null,"code":"import _toConsumableArray from\"/Users/jonsam/Projects/update_in_github/2020-year-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/jonsam/Projects/update_in_github/2020-year-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import config from\"../../config\";import TimeBlock from\"../common/timeBlock\";import{useHistory}from\"react-router-dom\";import badgeImage from\"../../assets/image/0.png\";import style from\"./index.module.scss\";var LockPage=function LockPage(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showKeyboard=_useState2[0],setShowKeyboard=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),pass=_useState4[0],setPass=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),tryAgain=_useState6[0],setTryAgain=_useState6[1];var defaultPass=config.defaultPass,cdnUrl=config.cdnUrl;var history=useHistory();var getActiveClass=function getActiveClass(idx){return pass.length>=idx+1?style.active:\"\";};var keyboardMap=[{no:\"1\",term:\"\"},{no:\"2\",term:\"ABC\"},{no:\"3\",term:\"DEF\"},{no:\"4\",term:\"GHI\"},{no:\"5\",term:\"JKL\"},{no:\"6\",term:\"MNO\"},{no:\"7\",term:\"PQRS\"},{no:\"8\",term:\"TUV\"},{no:\"9\",term:\"WXYZ\"},{no:\"0\",term:\"\"}];useEffect(function(){if(pass.length>=4){if(pass.join(\"\")===defaultPass){setTimeout(function(){history.push(\"/desktop\");},500);}else{setTryAgain(true);setPass([]);setTimeout(function(){setTryAgain(false);},1000);}}},[pass,defaultPass,history]);var handleDelete=function handleDelete(e){e.stopPropagation();if(!pass.length&&showKeyboard){setShowKeyboard(false);return;}setPass(pass.join(\"\").slice(0,-1).split(\"\"));};var handleKeyboardClick=function handleKeyboardClick(e,no){e.stopPropagation();setPass(function(){var p=[].concat(_toConsumableArray(pass),[no]);return p;});};var handleTouchScreen=function handleTouchScreen(e){e.stopPropagation();e.preventDefault();setShowKeyboard(true);};return/*#__PURE__*/React.createElement(\"div\",{className:style.lock_container,onClick:handleTouchScreen,onTouchStart:handleTouchScreen},!showKeyboard&&/*#__PURE__*/React.createElement(\"div\",{className:style.lock_screen},/*#__PURE__*/React.createElement(TimeBlock,null),/*#__PURE__*/React.createElement(\"div\",{className:style.lock_card},/*#__PURE__*/React.createElement(\"div\",{className:style.card_header},/*#__PURE__*/React.createElement(\"div\",{className:style.card_badge},/*#__PURE__*/React.createElement(\"img\",{src:badgeImage,alt:\"badgeImage\"}),/*#__PURE__*/React.createElement(\"span\",null,\"\\u5B9C\\u5DDD\\u4E2D\\u5B66\\u6559\\u80B2\\u96C6\\u56E2\\u5BA2\\u6237\\u7AEF\")),/*#__PURE__*/React.createElement(\"span\",null,\"\\u521A\\u521A\")),/*#__PURE__*/React.createElement(\"p\",null,\"\\u5E9A\\u5B50\\u9F20\\u5E74\\uFF0C\\u5B9C\\u4E2D\\u4EBA\\u540C\\u5FC3\\u540C\\u884C\\uFF0C\\u4E00\\u5F80\\u65E0\\u524D\\uFF01\\u97AD\\u70AE\\u54CD\\uFF0C\\u65B0\\u5E74\\u5230\\uFF01\\u8BA9\\u6211\\u4EEC\\u97AD\\u8E44\\uFF0C\\u725B\\u6765\\u8FD0\\u8F6C\\uFF01\\u5B34\\u5728\\u5F00\\u95E8\\uFF0C\\u80DC\\u5728\\u725B\\u5E74\\uFF01>>\")),/*#__PURE__*/React.createElement(\"div\",{className:style.lock_trigger},/*#__PURE__*/React.createElement(\"p\",{className:style.lock_hint},\"\\u5411\\u4E0A\\u6ED1\\u5C4F\\u4EE5\\u89E3\\u9501\"),/*#__PURE__*/React.createElement(\"div\",{className:style.lock_arrow},/*#__PURE__*/React.createElement(\"div\",{className:style.arrow_ani}),/*#__PURE__*/React.createElement(\"div\",{className:style.arrow_ani})))),showKeyboard&&/*#__PURE__*/React.createElement(\"div\",{className:style.lock_keyboard},/*#__PURE__*/React.createElement(\"div\",{className:style.input_pass},/*#__PURE__*/React.createElement(\"p\",null,\"\\u8BF7\\u8F93\\u5165\\u5BC6\\u78012021\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"\".concat(tryAgain?style.pass_ani:\"\")},[0,1,2,3].map(function(idx){return/*#__PURE__*/React.createElement(\"li\",{className:\"\".concat(style.pass_dot,\" \").concat(getActiveClass(idx)),key:idx});}))),/*#__PURE__*/React.createElement(\"div\",{className:style.visual_keyboard_wrapper},/*#__PURE__*/React.createElement(\"div\",{className:style.visual_keyboard},keyboardMap.map(function(_ref){var no=_ref.no,term=_ref.term;return/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(style.board_item),\"data-index\":no,key:no,onClick:function onClick(e){return handleKeyboardClick(e,no);}},/*#__PURE__*/React.createElement(\"span\",null,no),/*#__PURE__*/React.createElement(\"span\",null,term));}))),/*#__PURE__*/React.createElement(\"div\",{className:style.opt_panel},/*#__PURE__*/React.createElement(\"span\",null,\"\\u7D27\\u6025\\u547C\\u53EB\"),/*#__PURE__*/React.createElement(\"span\",{onClick:handleDelete},pass.length?\"删除\":\"返回\"))),/*#__PURE__*/React.createElement(\"audio\",{src:\"\".concat(cdnUrl,\"/call.mp3\"),autoPlay:true,loop:false}));};export default LockPage;","map":{"version":3,"sources":["/Users/jonsam/Projects/update_in_github/2020-year-end/src/components/lock/index.tsx"],"names":["React","useState","useEffect","config","TimeBlock","useHistory","badgeImage","style","LockPage","showKeyboard","setShowKeyboard","pass","setPass","tryAgain","setTryAgain","defaultPass","cdnUrl","history","getActiveClass","idx","length","active","keyboardMap","no","term","join","setTimeout","push","handleDelete","e","stopPropagation","slice","split","handleKeyboardClick","p","handleTouchScreen","preventDefault","lock_container","lock_screen","lock_card","card_header","card_badge","lock_trigger","lock_hint","lock_arrow","arrow_ani","lock_keyboard","input_pass","pass_ani","map","pass_dot","visual_keyboard_wrapper","visual_keyboard","board_item","opt_panel"],"mappings":"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","sourcesContent":["import React, { FC, useState, useEffect } from \"react\";\nimport config from \"../../config\";\nimport TimeBlock from \"../common/timeBlock\";\nimport { useHistory } from \"react-router-dom\";\nimport badgeImage from \"../../assets/image/0.png\";\nimport style from \"./index.module.scss\";\n\nconst LockPage: FC = () => {\n  const [showKeyboard, setShowKeyboard] = useState<boolean>(false);\n  const [pass, setPass] = useState<string[]>([]);\n  const [tryAgain, setTryAgain] = useState<boolean>(false);\n  const {defaultPass, cdnUrl} = config;\n  const history = useHistory();\n\n  const getActiveClass = (idx: number) =>\n    pass.length >= idx + 1 ? style.active : \"\";\n  const keyboardMap = [\n    {\n      no: \"1\",\n      term: \"\",\n    },\n    {\n      no: \"2\",\n      term: \"ABC\",\n    },\n    {\n      no: \"3\",\n      term: \"DEF\",\n    },\n    {\n      no: \"4\",\n      term: \"GHI\",\n    },\n    {\n      no: \"5\",\n      term: \"JKL\",\n    },\n    {\n      no: \"6\",\n      term: \"MNO\",\n    },\n    {\n      no: \"7\",\n      term: \"PQRS\",\n    },\n    {\n      no: \"8\",\n      term: \"TUV\",\n    },\n    {\n      no: \"9\",\n      term: \"WXYZ\",\n    },\n    {\n      no: \"0\",\n      term: \"\",\n    },\n  ];\n\n  useEffect(() => {\n    if(pass.length >= 4 ) {\n      if(pass.join(\"\") === defaultPass) {\n        setTimeout(() => {\n          history.push(\"/desktop\");\n        }, 500)\n      }else {\n        setTryAgain(true);\n        setPass([]);\n        setTimeout(() => {\n          setTryAgain(false);\n        }, 1000)\n      }\n    } \n  }, [pass, defaultPass, history]);\n\n  const handleDelete = (e: any) => {\n    e.stopPropagation();\n    if (!pass.length && showKeyboard) {\n      setShowKeyboard(false);\n      return;\n    }\n    setPass(pass.join(\"\").slice(0, -1).split(\"\"));\n  };\n\n  const handleKeyboardClick = (e: any, no:string) => {\n    e.stopPropagation();\n    setPass(() => {\n      let p = [...pass, no];\n      return p;\n    })\n  }\n\n  const handleTouchScreen = (e: any) => {\n    e.stopPropagation();\n    e.preventDefault();\n    setShowKeyboard(true);\n  }\n\n  return (\n    <div\n      className={style.lock_container}\n      onClick={handleTouchScreen}\n      onTouchStart={handleTouchScreen}\n    >\n      {!showKeyboard && (\n        <div className={style.lock_screen}>\n          <TimeBlock />\n          <div className={style.lock_card}>\n            <div className={style.card_header}>\n              <div className={style.card_badge}>\n                <img src={badgeImage} alt=\"badgeImage\" />\n                <span>宜川中学教育集团客户端</span>\n              </div>\n              <span>刚刚</span>\n            </div>\n            <p>\n            庚子鼠年，宜中人同心同行，一往无前！鞭炮响，新年到！让我们鞭蹄，牛来运转！嬴在开门，胜在牛年！>>\n            </p>\n          </div>\n          <div className={style.lock_trigger}>\n            <p className={style.lock_hint}>向上滑屏以解锁</p>\n            <div className={style.lock_arrow}>\n              <div className={style.arrow_ani} />\n              <div className={style.arrow_ani} />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showKeyboard && (\n        <div className={style.lock_keyboard}>\n          <div className={style.input_pass}>\n            <p>请输入密码2021</p>\n            <ul className={`${tryAgain ? style.pass_ani : \"\"}`}>\n              {[0, 1, 2, 3].map((idx) => (\n                <li\n                  className={`${style.pass_dot} ${getActiveClass(idx)}`}\n                  key={idx}\n                />\n              ))}\n            </ul>\n          </div>\n          <div className={style.visual_keyboard_wrapper}>\n            <div className={style.visual_keyboard}>\n            {keyboardMap.map(({ no, term }) => (\n              <div\n                className={`${style.board_item}`}\n                data-index={no}\n                key={no}\n                onClick={(e) => handleKeyboardClick(e, no)}\n              >\n                <span>{no}</span>\n                <span>{term}</span>\n              </div>\n            ))}\n            </div>\n          </div>\n          <div className={style.opt_panel}>\n            <span>紧急呼叫</span>\n            <span onClick={handleDelete}>{pass.length ? \"删除\" : \"返回\"}</span>\n          </div>\n        </div>\n      )}\n\n      <audio src={`${cdnUrl}/call.mp3`} autoPlay={true} loop={false}/>\n    </div>\n  );\n};\n\nexport default LockPage;\n"]},"metadata":{},"sourceType":"module"}